{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": 3,
  "links": [],
  "panels": [
    {
      "datasource": {
        "type": "prometheus",
        "uid": "cdpnaut6d5eyoa"
      },
      "gridPos": {
        "h": 15,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 2,
      "options": {
        "baidu": {
          "callback": "bmapReady",
          "key": ""
        },
        "editor": {
          "format": "auto"
        },
        "editorMode": "code",
        "gaode": {
          "key": "",
          "plugin": "AMap.Scale,AMap.ToolBar"
        },
        "getOption": "const nodes = [];\nconst links = [];\ncontext.panel.data.series.map((s, i) => {\n  const labelMap = s.fields.find((f) => f.type === 'number').labels;\n  if (nodes.indexOf(labelMap.service_from) == -1) {\n    nodes.push(labelMap.service_from)\n  }\n  if (nodes.indexOf(labelMap.service_to) == -1) {\n    nodes.push(labelMap.service_to)\n  }\n  links.push({\n    source: nodes.indexOf(labelMap.service_from),\n    target: nodes.indexOf(labelMap.service_to)\n  })\n});\n\nconst graphNode = nodes.map((node, index) => {\n  return {\n    id: index,\n    name: node\n  }\n})\n\nreturn {\n  tooltip: {},\n  series: [\n    {\n      type: 'graph',\n      layout: 'force',\n      force: {\n        gravity: 0.5,\n        repulsion: 500,\n        edgeLength: 400\n      },\n      legendHoverLink: false,\n      data: graphNode,\n      categories: [],\n      animation: false,\n      draggable: true,\n      links: links,\n      roam: true,\n      edgeSymbol: ['arrow'],\n      symbolSize: 75,\n      labelLayout: {\n        hideOverlap: true\n      },\n      label: {\n        show: true\n      },\n      emphasis: {\n        focus: 'adjacency'\n      },\n      scaleLimit: {\n        min: 0.4,\n        max: 2\n      }\n    }\n  ]\n};",
        "google": {
          "callback": "gmapReady",
          "key": ""
        },
        "map": "none",
        "renderer": "svg",
        "themeEditor": {
          "config": "{}",
          "name": "default"
        },
        "visualEditor": {
          "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
          "dataset": [
            {
              "name": "http_request_count",
              "source": "A"
            },
            {
              "name": "Time",
              "source": "A"
            }
          ],
          "series": []
        }
      },
      "pluginVersion": "6.1.0",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "cdpnaut6d5eyoa"
          },
          "disableTextWrap": false,
          "editorMode": "builder",
          "expr": "http_request_count",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "instant": false,
          "legendFormat": "__auto",
          "range": true,
          "refId": "A",
          "useBackend": false
        }
      ],
      "title": "Mesh Visualization",
      "type": "volkovlabs-echarts-panel"
    },
    {
      "datasource": {
        "type": "prometheus",
        "uid": "${DataSource}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "E2E Delay"
            },
            "properties": [
              {
                "id": "unit",
                "value": "s"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 15
      },
      "id": 1,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "11.0.1",
      "targets": [
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${DataSource}"
          },
          "disableTextWrap": false,
          "editorMode": "builder",
          "exemplar": false,
          "expr": "http_e2e_delay{quantile=\"0.99\"}",
          "format": "table",
          "fullMetaSearch": false,
          "includeNullMetadata": true,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "A",
          "useBackend": false
        },
        {
          "datasource": {
            "type": "prometheus",
            "uid": "${DataSource}"
          },
          "disableTextWrap": false,
          "editorMode": "builder",
          "exemplar": false,
          "expr": "increase(http_request_count[$__rate_interval])",
          "format": "table",
          "fullMetaSearch": false,
          "hide": false,
          "includeNullMetadata": true,
          "instant": true,
          "legendFormat": "__auto",
          "range": false,
          "refId": "B",
          "useBackend": false
        }
      ],
      "title": "Mesh Stats",
      "transformations": [
        {
          "id": "joinByField",
          "options": {
            "byField": "service_to",
            "mode": "outer"
          }
        },
        {
          "id": "sortBy",
          "options": {
            "fields": {},
            "sort": [
              {
                "field": "service_to"
              }
            ]
          }
        },
        {
          "id": "organize",
          "options": {
            "excludeByName": {
              "Time 1": true,
              "Time 2": true,
              "__name__": true,
              "__name__ 1": true,
              "__name__ 2": true,
              "instance 1": true,
              "instance 2": true,
              "job 1": true,
              "job 2": true,
              "quantile": true,
              "service_from 1": true,
              "service_from 2": true
            },
            "includeByName": {},
            "indexByName": {},
            "renameByName": {
              "Value #A": "E2E Delay",
              "Value #B": "Increase #Requests",
              "service_to": "Service"
            }
          }
        }
      ],
      "type": "table"
    }
  ],
  "schemaVersion": 39,
  "tags": [],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "prometheus",
          "value": "cdpnaut6d5eyoa"
        },
        "hide": 0,
        "includeAll": false,
        "multi": false,
        "name": "DataSource",
        "options": [],
        "query": "prometheus",
        "refresh": 1,
        "regex": "prometheus",
        "skipUrlSync": false,
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-7d",
    "to": "now"
  },
  "timeRangeUpdatedDuringEditOrView": false,
  "timepicker": {},
  "timezone": "browser",
  "title": "Mesh Metrics",
  "uid": "fdpobbqlk0e80d",
  "version": 28,
  "weekStart": ""
}